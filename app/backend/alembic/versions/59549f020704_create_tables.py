"""create tables

Revision ID: 59549f020704
Revises:
Create Date: 2026-02-05 00:53:44.966734

"""

from typing import Sequence, Union

import sqlalchemy as sa

from alembic import op

# revision identifiers, used by Alembic.
revision: str = "59549f020704"
down_revision: Union[str, Sequence[str], None] = None
branch_labels: Union[str, Sequence[str], None] = None
depends_on: Union[str, Sequence[str], None] = None


def upgrade() -> None:
    """Upgrade schema."""
    # ### commands auto generated by Alembic - please adjust! ###
    op.create_table(
        "blacklist_tokens",
        sa.Column("jti", sa.String(length=120), nullable=True),
        sa.Column("id", sa.UUID(), nullable=False),
        sa.Column(
            "created_at",
            sa.DateTime(timezone=True),
            server_default=sa.text("now()"),
            nullable=False,
        ),
        sa.Column(
            "updated_at",
            sa.DateTime(timezone=True),
            server_default=sa.text("now()"),
            nullable=False,
        ),
        sa.PrimaryKeyConstraint("id"),
        sa.UniqueConstraint("jti"),
    )
    op.create_table(
        "tables",
        sa.Column("name", sa.String(length=50), nullable=False),
        sa.Column("id", sa.UUID(), nullable=False),
        sa.Column(
            "created_at",
            sa.DateTime(timezone=True),
            server_default=sa.text("now()"),
            nullable=False,
        ),
        sa.Column(
            "updated_at",
            sa.DateTime(timezone=True),
            server_default=sa.text("now()"),
            nullable=False,
        ),
        sa.PrimaryKeyConstraint("id"),
        sa.UniqueConstraint("name"),
    )
    op.create_table(
        "users",
        sa.Column("identification", sa.String(length=120), nullable=False),
        sa.Column("password", sa.String(length=120), nullable=False),
        sa.Column(
            "role",
            sa.Enum(
                "admin",
                "teacher",
                "student",
                "other",
                name="role_enum",
                native_enum=False,
            ),
            nullable=False,
        ),
        sa.Column("image_path", sa.String(length=255), nullable=True),
        sa.Column("id", sa.UUID(), nullable=False),
        sa.Column(
            "created_at",
            sa.DateTime(timezone=True),
            server_default=sa.text("now()"),
            nullable=False,
        ),
        sa.Column(
            "updated_at",
            sa.DateTime(timezone=True),
            server_default=sa.text("now()"),
            nullable=False,
        ),
        sa.PrimaryKeyConstraint("id"),
        sa.UniqueConstraint("identification"),
    )
    op.create_table(
        "years",
        sa.Column(
            "calendar_type",
            sa.Enum("Semester", "Quarter", name="term_type_enum"),
            nullable=False,
        ),
        sa.Column("name", sa.String(length=100), nullable=False),
        sa.Column("start_date", sa.Date(), nullable=False),
        sa.Column("end_date", sa.Date(), nullable=False),
        sa.Column(
            "status",
            sa.Enum(
                "upcoming", "active", "completed", "archived", name="year_status_enum"
            ),
            nullable=False,
        ),
        sa.Column("id", sa.UUID(), nullable=False),
        sa.Column(
            "created_at",
            sa.DateTime(timezone=True),
            server_default=sa.text("now()"),
            nullable=False,
        ),
        sa.Column(
            "updated_at",
            sa.DateTime(timezone=True),
            server_default=sa.text("now()"),
            nullable=False,
        ),
        sa.PrimaryKeyConstraint("id"),
    )
    op.create_table(
        "academic_terms",
        sa.Column("year_id", sa.UUID(), nullable=False),
        sa.Column(
            "name",
            sa.Enum("1", "2", "3", "4", name="academic_term_enum"),
            nullable=False,
        ),
        sa.Column("start_date", sa.Date(), nullable=True),
        sa.Column("end_date", sa.Date(), nullable=True),
        sa.Column("registration_start", sa.Date(), nullable=True),
        sa.Column("registration_end", sa.Date(), nullable=True),
        sa.Column("id", sa.UUID(), nullable=False),
        sa.Column(
            "created_at",
            sa.DateTime(timezone=True),
            server_default=sa.text("now()"),
            nullable=False,
        ),
        sa.Column(
            "updated_at",
            sa.DateTime(timezone=True),
            server_default=sa.text("now()"),
            nullable=False,
        ),
        sa.CheckConstraint(
            "registration_start <= registration_end",
            name="check_term_registration_dates",
        ),
        sa.CheckConstraint("start_date <= end_date", name="check_term_dates"),
        sa.ForeignKeyConstraint(["year_id"], ["years.id"], ondelete="CASCADE"),
        sa.PrimaryKeyConstraint("id"),
    )
    op.create_table(
        "admins",
        sa.Column("first_name", sa.String(length=50), nullable=False),
        sa.Column("father_name", sa.String(length=50), nullable=False),
        sa.Column("grand_father_name", sa.String(length=50), nullable=False),
        sa.Column("date_of_birth", sa.Date(), nullable=False),
        sa.Column(
            "gender",
            sa.Enum("male", "female", name="gender_enum", native_enum=False),
            nullable=False,
        ),
        sa.Column("email", sa.String(length=120), nullable=False),
        sa.Column("phone", sa.String(length=25), nullable=False),
        sa.Column("address", sa.Text(), nullable=False),
        sa.Column("user_id", sa.UUID(), nullable=True),
        sa.Column("id", sa.UUID(), nullable=False),
        sa.Column(
            "created_at",
            sa.DateTime(timezone=True),
            server_default=sa.text("now()"),
            nullable=False,
        ),
        sa.Column(
            "updated_at",
            sa.DateTime(timezone=True),
            server_default=sa.text("now()"),
            nullable=False,
        ),
        sa.ForeignKeyConstraint(["user_id"], ["users.id"], ondelete="CASCADE"),
        sa.PrimaryKeyConstraint("id"),
    )
    op.create_table(
        "events",
        sa.Column("year_id", sa.UUID(), nullable=False),
        sa.Column("title", sa.String(length=100), nullable=False),
        sa.Column("purpose", sa.String(length=50), nullable=False),
        sa.Column("organizer", sa.String(length=50), nullable=False),
        sa.Column("start_date", sa.Date(), nullable=False),
        sa.Column("end_date", sa.Date(), nullable=False),
        sa.Column("start_time", sa.DateTime(), nullable=False),
        sa.Column("end_time", sa.DateTime(), nullable=False),
        sa.Column("location", sa.String(length=50), nullable=True),
        sa.Column("is_hybrid", sa.Boolean(), nullable=False),
        sa.Column("online_link", sa.Text(), nullable=True),
        sa.Column("eligibility", sa.String(length=50), nullable=True),
        sa.Column("has_fee", sa.Boolean(), nullable=False),
        sa.Column("fee_amount", sa.Integer(), nullable=False),
        sa.Column("description", sa.String(length=255), nullable=True),
        sa.Column("id", sa.UUID(), nullable=False),
        sa.Column(
            "created_at",
            sa.DateTime(timezone=True),
            server_default=sa.text("now()"),
            nullable=False,
        ),
        sa.Column(
            "updated_at",
            sa.DateTime(timezone=True),
            server_default=sa.text("now()"),
            nullable=False,
        ),
        sa.CheckConstraint("start_date <= end_date", name="check_event_dates"),
        sa.CheckConstraint("start_time <= end_time", name="check_event_times"),
        sa.ForeignKeyConstraint(["year_id"], ["years.id"], ondelete="CASCADE"),
        sa.PrimaryKeyConstraint("id"),
    )
    op.create_table(
        "grades",
        sa.Column("year_id", sa.UUID(), nullable=False),
        sa.Column(
            "grade",
            sa.Enum(
                "1",
                "2",
                "3",
                "4",
                "5",
                "6",
                "7",
                "8",
                "9",
                "10",
                "11",
                "12",
                name="grade_enum",
                native_enum=False,
            ),
            nullable=False,
        ),
        sa.Column(
            "level",
            sa.Enum(
                "primary",
                "middle school",
                "high school",
                name="grade_level_enum",
                native_enum=False,
            ),
            nullable=False,
        ),
        sa.Column("has_stream", sa.Boolean(), nullable=False),
        sa.Column("id", sa.UUID(), nullable=False),
        sa.Column(
            "created_at",
            sa.DateTime(timezone=True),
            server_default=sa.text("now()"),
            nullable=False,
        ),
        sa.Column(
            "updated_at",
            sa.DateTime(timezone=True),
            server_default=sa.text("now()"),
            nullable=False,
        ),
        sa.ForeignKeyConstraint(["year_id"], ["years.id"], ondelete="CASCADE"),
        sa.PrimaryKeyConstraint("id"),
    )
    op.create_index(op.f("ix_grades_year_id"), "grades", ["year_id"], unique=False)
    op.create_table(
        "saved_query_views",
        sa.Column("user_id", sa.UUID(), nullable=False),
        sa.Column("name", sa.String(length=50), nullable=False),
        sa.Column(
            "table_name",
            sa.Enum(
                "students",
                "teachers",
                "admin",
                "semesters",
                name="table_enum",
                native_enum=False,
            ),
            nullable=False,
        ),
        sa.Column("query_json", sa.JSON(), nullable=False),
        sa.Column("id", sa.UUID(), nullable=False),
        sa.Column(
            "created_at",
            sa.DateTime(timezone=True),
            server_default=sa.text("now()"),
            nullable=False,
        ),
        sa.Column(
            "updated_at",
            sa.DateTime(timezone=True),
            server_default=sa.text("now()"),
            nullable=False,
        ),
        sa.ForeignKeyConstraint(["user_id"], ["users.id"], ondelete="CASCADE"),
        sa.PrimaryKeyConstraint("id"),
    )
    op.create_table(
        "subjects",
        sa.Column("year_id", sa.UUID(), nullable=False),
        sa.Column("name", sa.String(length=50), nullable=False),
        sa.Column("code", sa.String(length=20), nullable=False),
        sa.Column("id", sa.UUID(), nullable=False),
        sa.Column(
            "created_at",
            sa.DateTime(timezone=True),
            server_default=sa.text("now()"),
            nullable=False,
        ),
        sa.Column(
            "updated_at",
            sa.DateTime(timezone=True),
            server_default=sa.text("now()"),
            nullable=False,
        ),
        sa.ForeignKeyConstraint(["year_id"], ["years.id"], ondelete="CASCADE"),
        sa.PrimaryKeyConstraint("id"),
    )
    op.create_index(op.f("ix_subjects_year_id"), "subjects", ["year_id"], unique=False)
    op.create_table(
        "employees",
        sa.Column("first_name", sa.String(length=50), nullable=False),
        sa.Column("father_name", sa.String(length=50), nullable=False),
        sa.Column("grand_father_name", sa.String(length=50), nullable=False),
        sa.Column("date_of_birth", sa.Date(), nullable=False),
        sa.Column(
            "gender",
            sa.Enum("male", "female", name="gender_enum", native_enum=False),
            nullable=False,
        ),
        sa.Column("nationality", sa.String(length=50), nullable=False),
        sa.Column("social_security_number", sa.String(length=50), nullable=False),
        sa.Column("address", sa.Text(), nullable=False),
        sa.Column("city", sa.String(length=50), nullable=False),
        sa.Column("state", sa.String(length=50), nullable=False),
        sa.Column("country", sa.String(length=50), nullable=False),
        sa.Column("primary_phone", sa.String(length=50), nullable=False),
        sa.Column("personal_email", sa.String(length=50), nullable=False),
        sa.Column("emergency_contact_name", sa.String(length=50), nullable=False),
        sa.Column("emergency_contact_relation", sa.String(length=50), nullable=False),
        sa.Column("emergency_contact_phone", sa.String(length=50), nullable=False),
        sa.Column(
            "highest_education",
            sa.Enum(
                "bachelors",
                "masters",
                "doctorate",
                name="highest_education_enum",
                native_enum=False,
            ),
            nullable=False,
        ),
        sa.Column("university", sa.String(length=50), nullable=False),
        sa.Column("graduation_year", sa.Integer(), nullable=False),
        sa.Column("gpa", sa.Float(), nullable=False),
        sa.Column(
            "position",
            sa.Enum(
                "administrative staff",
                "teaching staff",
                "support staff",
                "maintenance staff",
                "counselor",
                "librarian",
                "IT support",
                "other",
                name="employee_position_enum",
                native_enum=False,
            ),
            nullable=False,
        ),
        sa.Column(
            "years_of_experience",
            sa.Enum(
                "0",
                "1-2",
                "3-5",
                "6-10",
                "11-15",
                "16-20",
                "20+",
                name="experience_year_enum",
                native_enum=False,
            ),
            nullable=False,
        ),
        sa.Column("reference1_name", sa.String(length=50), nullable=False),
        sa.Column("reference1_organization", sa.String(length=50), nullable=False),
        sa.Column("reference1_phone", sa.String(length=50), nullable=False),
        sa.Column("reference1_email", sa.String(length=50), nullable=True),
        sa.Column(
            "marital_status",
            sa.Enum(
                "single",
                "married",
                "divorced",
                "widowed",
                "prefer-not-to-say",
                name="marital_status_enum",
                native_enum=False,
            ),
            nullable=True,
        ),
        sa.Column("secondary_phone", sa.String(length=50), nullable=True),
        sa.Column("certifications", sa.Text(), nullable=True),
        sa.Column("resume", sa.String(length=50), nullable=True),
        sa.Column("background_check", sa.Text(), nullable=True),
        sa.Column("user_id", sa.UUID(), nullable=True),
        sa.Column("subject_id", sa.UUID(), nullable=True),
        sa.Column(
            "status",
            sa.Enum(
                "pending",
                "approved",
                "rejected",
                "interview-scheduled",
                "active",
                "inactive",
                "withdrawn",
                name="status_enum",
                native_enum=False,
            ),
            nullable=False,
        ),
        sa.Column("id", sa.UUID(), nullable=False),
        sa.Column(
            "created_at",
            sa.DateTime(timezone=True),
            server_default=sa.text("now()"),
            nullable=False,
        ),
        sa.Column(
            "updated_at",
            sa.DateTime(timezone=True),
            server_default=sa.text("now()"),
            nullable=False,
        ),
        sa.CheckConstraint(
            "gpa >= 0.0 AND gpa <= 4.0", name="check_employee_gpa_range"
        ),
        sa.ForeignKeyConstraint(["subject_id"], ["subjects.id"], ondelete="SET NULL"),
        sa.ForeignKeyConstraint(["user_id"], ["users.id"], ondelete="CASCADE"),
        sa.PrimaryKeyConstraint("id"),
        sa.UniqueConstraint("user_id"),
    )
    op.create_table(
        "sections",
        sa.Column("grade_id", sa.UUID(), nullable=False),
        sa.Column("section", sa.String(length=1), nullable=True),
        sa.Column("id", sa.UUID(), nullable=False),
        sa.Column(
            "created_at",
            sa.DateTime(timezone=True),
            server_default=sa.text("now()"),
            nullable=False,
        ),
        sa.Column(
            "updated_at",
            sa.DateTime(timezone=True),
            server_default=sa.text("now()"),
            nullable=False,
        ),
        sa.ForeignKeyConstraint(["grade_id"], ["grades.id"], ondelete="CASCADE"),
        sa.PrimaryKeyConstraint("id"),
    )
    op.create_table(
        "streams",
        sa.Column("grade_id", sa.UUID(), nullable=False),
        sa.Column("name", sa.String(length=50), nullable=False),
        sa.Column("id", sa.UUID(), nullable=False),
        sa.Column(
            "created_at",
            sa.DateTime(timezone=True),
            server_default=sa.text("now()"),
            nullable=False,
        ),
        sa.Column(
            "updated_at",
            sa.DateTime(timezone=True),
            server_default=sa.text("now()"),
            nullable=False,
        ),
        sa.ForeignKeyConstraint(["grade_id"], ["grades.id"], ondelete="CASCADE"),
        sa.PrimaryKeyConstraint("id"),
        sa.UniqueConstraint("grade_id", "name", name="uq_grade_name"),
    )
    op.create_table(
        "students",
        sa.Column("registered_for_grade_id", sa.UUID(), nullable=False),
        sa.Column("first_name", sa.String(length=50), nullable=False),
        sa.Column("father_name", sa.String(length=50), nullable=False),
        sa.Column("date_of_birth", sa.Date(), nullable=False),
        sa.Column(
            "gender",
            sa.Enum("male", "female", name="gender_enum", native_enum=False),
            nullable=False,
        ),
        sa.Column("address", sa.Text(), nullable=False),
        sa.Column("city", sa.String(length=50), nullable=False),
        sa.Column("state", sa.String(length=50), nullable=False),
        sa.Column("postal_code", sa.String(length=20), nullable=False),
        sa.Column("father_phone", sa.String(length=25), nullable=False),
        sa.Column("mother_phone", sa.String(length=25), nullable=False),
        sa.Column("parent_email", sa.String(length=120), nullable=False),
        sa.Column("grand_father_name", sa.String(length=50), nullable=True),
        sa.Column("nationality", sa.String(length=100), nullable=True),
        sa.Column(
            "blood_type",
            sa.Enum(
                "A+",
                "A-",
                "B+",
                "B-",
                "AB+",
                "AB-",
                "O+",
                "O-",
                "unknown",
                name="blood_type_enum",
                native_enum=False,
            ),
            nullable=True,
        ),
        sa.Column("student_photo", sa.String(length=255), nullable=True),
        sa.Column("previous_school", sa.String(length=100), nullable=True),
        sa.Column("previous_grades", sa.Text(), nullable=True),
        sa.Column("transportation", sa.String(length=50), nullable=True),
        sa.Column("guardian_name", sa.String(length=50), nullable=True),
        sa.Column("guardian_phone", sa.String(length=25), nullable=True),
        sa.Column("guardian_relation", sa.String(length=50), nullable=True),
        sa.Column("emergency_contact_name", sa.String(length=50), nullable=True),
        sa.Column("emergency_contact_phone", sa.String(length=25), nullable=True),
        sa.Column("disability_details", sa.Text(), nullable=True),
        sa.Column("sibling_details", sa.Text(), nullable=True),
        sa.Column("medical_details", sa.Text(), nullable=True),
        sa.Column("sibling_in_school", sa.Boolean(), nullable=False),
        sa.Column("has_medical_condition", sa.Boolean(), nullable=False),
        sa.Column("has_disability", sa.Boolean(), nullable=False),
        sa.Column("is_transfer", sa.Boolean(), nullable=False),
        sa.Column(
            "status",
            sa.Enum(
                "pending",
                "rejected",
                "active",
                "inactive",
                "graduated",
                "suspended",
                "withdrawn",
                name="student_application_status_enum",
                native_enum=False,
            ),
            nullable=False,
        ),
        sa.Column("user_id", sa.UUID(), nullable=True),
        sa.Column("id", sa.UUID(), nullable=False),
        sa.Column(
            "created_at",
            sa.DateTime(timezone=True),
            server_default=sa.text("now()"),
            nullable=False,
        ),
        sa.Column(
            "updated_at",
            sa.DateTime(timezone=True),
            server_default=sa.text("now()"),
            nullable=False,
        ),
        sa.ForeignKeyConstraint(
            ["registered_for_grade_id"],
            ["grades.id"],
        ),
        sa.ForeignKeyConstraint(["user_id"], ["users.id"], ondelete="CASCADE"),
        sa.PrimaryKeyConstraint("id"),
        sa.UniqueConstraint("user_id"),
    )
    op.create_table(
        "employee_year_links",
        sa.Column("employee_id", sa.UUID(), nullable=False),
        sa.Column("year_id", sa.UUID(), nullable=False),
        sa.ForeignKeyConstraint(["employee_id"], ["employees.id"], ondelete="CASCADE"),
        sa.ForeignKeyConstraint(["year_id"], ["years.id"], ondelete="CASCADE"),
        sa.PrimaryKeyConstraint("employee_id", "year_id"),
        sa.UniqueConstraint("employee_id", "year_id", name="uq_employee_year_links"),
    )
    op.create_table(
        "grade_section_links",
        sa.Column("section_id", sa.UUID(), nullable=False),
        sa.Column("grade_id", sa.UUID(), nullable=False),
        sa.ForeignKeyConstraint(["grade_id"], ["grades.id"], ondelete="CASCADE"),
        sa.ForeignKeyConstraint(["section_id"], ["sections.id"], ondelete="CASCADE"),
        sa.PrimaryKeyConstraint("section_id", "grade_id"),
    )
    op.create_table(
        "grade_stream_links",
        sa.Column("grade_id", sa.UUID(), nullable=False),
        sa.Column("stream_id", sa.UUID(), nullable=False),
        sa.ForeignKeyConstraint(["grade_id"], ["grades.id"], ondelete="CASCADE"),
        sa.ForeignKeyConstraint(["stream_id"], ["streams.id"], ondelete="CASCADE"),
        sa.PrimaryKeyConstraint("grade_id", "stream_id"),
    )
    op.create_table(
        "grade_stream_subjects",
        sa.Column("grade_id", sa.UUID(), nullable=False),
        sa.Column("stream_id", sa.UUID(), nullable=True),
        sa.Column("subject_id", sa.UUID(), nullable=False),
        sa.Column("id", sa.UUID(), nullable=False),
        sa.Column(
            "created_at",
            sa.DateTime(timezone=True),
            server_default=sa.text("now()"),
            nullable=False,
        ),
        sa.Column(
            "updated_at",
            sa.DateTime(timezone=True),
            server_default=sa.text("now()"),
            nullable=False,
        ),
        sa.ForeignKeyConstraint(["grade_id"], ["grades.id"], ondelete="CASCADE"),
        sa.ForeignKeyConstraint(["stream_id"], ["streams.id"], ondelete="CASCADE"),
        sa.ForeignKeyConstraint(["subject_id"], ["subjects.id"], ondelete="CASCADE"),
        sa.PrimaryKeyConstraint("id"),
        sa.UniqueConstraint(
            "grade_id", "stream_id", "subject_id", name="uq_grade_stream_subject"
        ),
    )
    op.create_table(
        "registrations",
        sa.Column("student_id", sa.UUID(), nullable=False),
        sa.Column("subject_id", sa.UUID(), nullable=False),
        sa.Column("registration_date", sa.DateTime(), nullable=False),
        sa.Column("id", sa.UUID(), nullable=False),
        sa.Column(
            "created_at",
            sa.DateTime(timezone=True),
            server_default=sa.text("now()"),
            nullable=False,
        ),
        sa.Column(
            "updated_at",
            sa.DateTime(timezone=True),
            server_default=sa.text("now()"),
            nullable=False,
        ),
        sa.ForeignKeyConstraint(["student_id"], ["students.id"], ondelete="CASCADE"),
        sa.ForeignKeyConstraint(["subject_id"], ["subjects.id"], ondelete="CASCADE"),
        sa.PrimaryKeyConstraint("id"),
    )
    op.create_table(
        "student_academic_term_links",
        sa.Column("student_id", sa.UUID(), nullable=False),
        sa.Column("academic_term_id", sa.UUID(), nullable=False),
        sa.Column("average", sa.Float(), nullable=True),
        sa.Column("rank", sa.Integer(), nullable=True),
        sa.ForeignKeyConstraint(
            ["academic_term_id"], ["academic_terms.id"], ondelete="CASCADE"
        ),
        sa.ForeignKeyConstraint(["student_id"], ["students.id"], ondelete="CASCADE"),
        sa.PrimaryKeyConstraint("student_id", "academic_term_id"),
    )
    op.create_table(
        "student_grade_links",
        sa.Column("student_id", sa.UUID(), nullable=False),
        sa.Column("grade_id", sa.UUID(), nullable=False),
        sa.ForeignKeyConstraint(["grade_id"], ["grades.id"], ondelete="CASCADE"),
        sa.ForeignKeyConstraint(["student_id"], ["students.id"], ondelete="CASCADE"),
        sa.PrimaryKeyConstraint("student_id", "grade_id"),
    )
    op.create_table(
        "student_section_links",
        sa.Column("student_id", sa.UUID(), nullable=False),
        sa.Column("section_id", sa.UUID(), nullable=False),
        sa.ForeignKeyConstraint(["section_id"], ["sections.id"], ondelete="CASCADE"),
        sa.ForeignKeyConstraint(["student_id"], ["students.id"], ondelete="CASCADE"),
        sa.PrimaryKeyConstraint("student_id", "section_id"),
    )
    op.create_table(
        "student_stream_links",
        sa.Column("student_id", sa.UUID(), nullable=False),
        sa.Column("stream_id", sa.UUID(), nullable=False),
        sa.ForeignKeyConstraint(["stream_id"], ["streams.id"], ondelete="CASCADE"),
        sa.ForeignKeyConstraint(["student_id"], ["students.id"], ondelete="CASCADE"),
        sa.PrimaryKeyConstraint("student_id", "stream_id"),
    )
    op.create_table(
        "student_subject_links",
        sa.Column("student_id", sa.UUID(), nullable=False),
        sa.Column("subject_id", sa.UUID(), nullable=False),
        sa.Column("average", sa.Float(), nullable=True),
        sa.Column("rank", sa.Integer(), nullable=True),
        sa.ForeignKeyConstraint(["student_id"], ["students.id"], ondelete="CASCADE"),
        sa.ForeignKeyConstraint(["subject_id"], ["subjects.id"], ondelete="CASCADE"),
        sa.PrimaryKeyConstraint("student_id", "subject_id"),
    )
    op.create_table(
        "student_term_records",
        sa.Column("student_id", sa.UUID(), nullable=False),
        sa.Column("academic_term_id", sa.UUID(), nullable=False),
        sa.Column("grade_id", sa.UUID(), nullable=False),
        sa.Column("section_id", sa.UUID(), nullable=False),
        sa.Column("stream_id", sa.UUID(), nullable=True),
        sa.Column("average", sa.Float(), nullable=True),
        sa.Column("rank", sa.Integer(), nullable=True),
        sa.Column("id", sa.UUID(), nullable=False),
        sa.Column(
            "created_at",
            sa.DateTime(timezone=True),
            server_default=sa.text("now()"),
            nullable=False,
        ),
        sa.Column(
            "updated_at",
            sa.DateTime(timezone=True),
            server_default=sa.text("now()"),
            nullable=False,
        ),
        sa.ForeignKeyConstraint(
            ["academic_term_id"], ["academic_terms.id"], ondelete="CASCADE"
        ),
        sa.ForeignKeyConstraint(["grade_id"], ["grades.id"], ondelete="CASCADE"),
        sa.ForeignKeyConstraint(["section_id"], ["sections.id"], ondelete="CASCADE"),
        sa.ForeignKeyConstraint(["stream_id"], ["streams.id"], ondelete="CASCADE"),
        sa.ForeignKeyConstraint(["student_id"], ["students.id"], ondelete="CASCADE"),
        sa.PrimaryKeyConstraint("id"),
    )
    op.create_table(
        "student_year_links",
        sa.Column("student_id", sa.UUID(), nullable=False),
        sa.Column("year_id", sa.UUID(), nullable=False),
        sa.Column("average", sa.Float(), nullable=True),
        sa.Column("rank", sa.Integer(), nullable=True),
        sa.ForeignKeyConstraint(["student_id"], ["students.id"], ondelete="CASCADE"),
        sa.ForeignKeyConstraint(["year_id"], ["years.id"], ondelete="CASCADE"),
        sa.PrimaryKeyConstraint("student_id", "year_id"),
    )
    op.create_table(
        "student_year_records",
        sa.Column("student_id", sa.UUID(), nullable=False),
        sa.Column("grade_id", sa.UUID(), nullable=False),
        sa.Column("year_id", sa.UUID(), nullable=False),
        sa.Column("stream_id", sa.UUID(), nullable=True),
        sa.Column("final_score", sa.Float(), nullable=True),
        sa.Column("rank", sa.Integer(), nullable=True),
        sa.Column("id", sa.UUID(), nullable=False),
        sa.Column(
            "created_at",
            sa.DateTime(timezone=True),
            server_default=sa.text("now()"),
            nullable=False,
        ),
        sa.Column(
            "updated_at",
            sa.DateTime(timezone=True),
            server_default=sa.text("now()"),
            nullable=False,
        ),
        sa.ForeignKeyConstraint(["grade_id"], ["grades.id"], ondelete="CASCADE"),
        sa.ForeignKeyConstraint(["stream_id"], ["streams.id"], ondelete="CASCADE"),
        sa.ForeignKeyConstraint(["student_id"], ["students.id"], ondelete="CASCADE"),
        sa.ForeignKeyConstraint(["year_id"], ["years.id"], ondelete="CASCADE"),
        sa.PrimaryKeyConstraint("id"),
    )
    op.create_table(
        "yearly_subjects",
        sa.Column("subject_code", sa.String(length=25), nullable=False),
        sa.Column("year_id", sa.UUID(), nullable=False),
        sa.Column("subject_id", sa.UUID(), nullable=False),
        sa.Column("grade_id", sa.UUID(), nullable=False),
        sa.Column("stream_id", sa.UUID(), nullable=True),
        sa.Column("id", sa.UUID(), nullable=False),
        sa.Column(
            "created_at",
            sa.DateTime(timezone=True),
            server_default=sa.text("now()"),
            nullable=False,
        ),
        sa.Column(
            "updated_at",
            sa.DateTime(timezone=True),
            server_default=sa.text("now()"),
            nullable=False,
        ),
        sa.ForeignKeyConstraint(["grade_id"], ["grades.id"], ondelete="CASCADE"),
        sa.ForeignKeyConstraint(["stream_id"], ["streams.id"], ondelete="CASCADE"),
        sa.ForeignKeyConstraint(["subject_id"], ["subjects.id"], ondelete="CASCADE"),
        sa.ForeignKeyConstraint(["year_id"], ["years.id"], ondelete="CASCADE"),
        sa.PrimaryKeyConstraint("id"),
    )
    op.create_table(
        "assessments",
        sa.Column("student_id", sa.UUID(), nullable=False),
        sa.Column("student_term_record_id", sa.UUID(), nullable=False),
        sa.Column("yearly_subject_id", sa.UUID(), nullable=False),
        sa.Column("total", sa.Float(), nullable=True),
        sa.Column("rank", sa.Integer(), nullable=True),
        sa.Column("id", sa.UUID(), nullable=False),
        sa.Column(
            "created_at",
            sa.DateTime(timezone=True),
            server_default=sa.text("now()"),
            nullable=False,
        ),
        sa.Column(
            "updated_at",
            sa.DateTime(timezone=True),
            server_default=sa.text("now()"),
            nullable=False,
        ),
        sa.ForeignKeyConstraint(["student_id"], ["students.id"], ondelete="CASCADE"),
        sa.ForeignKeyConstraint(
            ["student_term_record_id"], ["student_term_records.id"], ondelete="CASCADE"
        ),
        sa.ForeignKeyConstraint(
            ["yearly_subject_id"], ["yearly_subjects.id"], ondelete="CASCADE"
        ),
        sa.PrimaryKeyConstraint("id"),
    )
    op.create_table(
        "mark_lists",
        sa.Column("student_id", sa.UUID(), nullable=False),
        sa.Column("student_term_record_id", sa.UUID(), nullable=False),
        sa.Column("subject_id", sa.UUID(), nullable=False),
        sa.Column(
            "type",
            sa.Enum(
                "TEST",
                "QUIZ",
                "ASSIGNMENT",
                "MIDTERM",
                "FINAL",
                name="mark_list_type",
                native_enum=False,
            ),
            nullable=False,
        ),
        sa.Column("percentage", sa.Integer(), nullable=False),
        sa.Column("score", sa.Float(), nullable=True),
        sa.Column("id", sa.UUID(), nullable=False),
        sa.Column(
            "created_at",
            sa.DateTime(timezone=True),
            server_default=sa.text("now()"),
            nullable=False,
        ),
        sa.Column(
            "updated_at",
            sa.DateTime(timezone=True),
            server_default=sa.text("now()"),
            nullable=False,
        ),
        sa.ForeignKeyConstraint(["student_id"], ["students.id"], ondelete="CASCADE"),
        sa.ForeignKeyConstraint(
            ["student_term_record_id"], ["student_term_records.id"], ondelete="CASCADE"
        ),
        sa.ForeignKeyConstraint(["subject_id"], ["subjects.id"], ondelete="CASCADE"),
        sa.PrimaryKeyConstraint("id"),
    )
    op.create_table(
        "subject_yearly_averages",
        sa.Column("student_id", sa.UUID(), nullable=False),
        sa.Column("yearly_subject_id", sa.UUID(), nullable=False),
        sa.Column("student_year_record_id", sa.UUID(), nullable=True),
        sa.Column("average", sa.Float(), nullable=True),
        sa.Column("rank", sa.Integer(), nullable=True),
        sa.Column("id", sa.UUID(), nullable=False),
        sa.Column(
            "created_at",
            sa.DateTime(timezone=True),
            server_default=sa.text("now()"),
            nullable=False,
        ),
        sa.Column(
            "updated_at",
            sa.DateTime(timezone=True),
            server_default=sa.text("now()"),
            nullable=False,
        ),
        sa.ForeignKeyConstraint(["student_id"], ["students.id"], ondelete="CASCADE"),
        sa.ForeignKeyConstraint(
            ["student_year_record_id"], ["student_year_records.id"], ondelete="CASCADE"
        ),
        sa.ForeignKeyConstraint(
            ["yearly_subject_id"], ["yearly_subjects.id"], ondelete="CASCADE"
        ),
        sa.PrimaryKeyConstraint("id"),
    )
    op.create_table(
        "teacher_records",
        sa.Column("employee_id", sa.UUID(), nullable=False),
        sa.Column("academic_term_id", sa.UUID(), nullable=False),
        sa.Column("grade_stream_subject_id", sa.UUID(), nullable=True),
        sa.Column("id", sa.UUID(), nullable=False),
        sa.Column(
            "created_at",
            sa.DateTime(timezone=True),
            server_default=sa.text("now()"),
            nullable=False,
        ),
        sa.Column(
            "updated_at",
            sa.DateTime(timezone=True),
            server_default=sa.text("now()"),
            nullable=False,
        ),
        sa.ForeignKeyConstraint(
            ["academic_term_id"], ["academic_terms.id"], ondelete="CASCADE"
        ),
        sa.ForeignKeyConstraint(["employee_id"], ["employees.id"], ondelete="CASCADE"),
        sa.ForeignKeyConstraint(
            ["grade_stream_subject_id"],
            ["grade_stream_subjects.id"],
            ondelete="SET NULL",
        ),
        sa.PrimaryKeyConstraint("id"),
        sa.UniqueConstraint(
            "employee_id",
            "academic_term_id",
            "grade_stream_subject_id",
            name="uq_teacher_record",
        ),
    )
    op.create_table(
        "teacher_record_links",
        sa.Column("teacher_record_id", sa.UUID(), nullable=False),
        sa.Column("section_id", sa.UUID(), nullable=False),
        sa.Column("id", sa.UUID(), nullable=False),
        sa.Column(
            "created_at",
            sa.DateTime(timezone=True),
            server_default=sa.text("now()"),
            nullable=False,
        ),
        sa.Column(
            "updated_at",
            sa.DateTime(timezone=True),
            server_default=sa.text("now()"),
            nullable=False,
        ),
        sa.ForeignKeyConstraint(["section_id"], ["sections.id"], ondelete="CASCADE"),
        sa.ForeignKeyConstraint(
            ["teacher_record_id"], ["teacher_records.id"], ondelete="CASCADE"
        ),
        sa.PrimaryKeyConstraint("id"),
        sa.UniqueConstraint(
            "teacher_record_id", "section_id", name="uq_teacher_record_links"
        ),
    )
    # ### end Alembic commands ###


def downgrade() -> None:
    """Downgrade schema."""
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_table("teacher_record_links")
    op.drop_table("teacher_records")
    op.drop_table("subject_yearly_averages")
    op.drop_table("mark_lists")
    op.drop_table("assessments")
    op.drop_table("yearly_subjects")
    op.drop_table("student_year_records")
    op.drop_table("student_year_links")
    op.drop_table("student_term_records")
    op.drop_table("student_subject_links")
    op.drop_table("student_stream_links")
    op.drop_table("student_section_links")
    op.drop_table("student_grade_links")
    op.drop_table("student_academic_term_links")
    op.drop_table("registrations")
    op.drop_table("grade_stream_subjects")
    op.drop_table("grade_stream_links")
    op.drop_table("grade_section_links")
    op.drop_table("employee_year_links")
    op.drop_table("students")
    op.drop_table("streams")
    op.drop_table("sections")
    op.drop_table("employees")
    op.drop_index(op.f("ix_subjects_year_id"), table_name="subjects")
    op.drop_table("subjects")
    op.drop_table("saved_query_views")
    op.drop_index(op.f("ix_grades_year_id"), table_name="grades")
    op.drop_table("grades")
    op.drop_table("events")
    op.drop_table("admins")
    op.drop_table("academic_terms")
    op.drop_table("years")
    op.drop_table("users")
    op.drop_table("tables")
    op.drop_table("blacklist_tokens")
    # ### end Alembic commands ###
